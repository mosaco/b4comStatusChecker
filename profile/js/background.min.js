function updateBadge(){for(var e,t=JSON.parse(lc.getItem("data")),a=lc.getItem("badgeType"),n=0,r=t.length;r>n;n++)if(t[n].name===a){e=t[n].value;break}chrome.browserAction.setBadgeBackgroundColor({color:"#fe6000"}),chrome.browserAction.setBadgeText({text:e.split(",").join("")})}function updateStatus(e){var t=new Date,a=JSON.parse(lc.getItem("data")),n=JSON.parse(lc.getItem("data"));if("offline"!==e){for(var r=e.querySelectorAll("#countBlock h2"),u=e.querySelectorAll(".countNumber"),i=e.querySelectorAll(".countValue"),o=0,s=a.length;s>o;o++)n[o].title=r[o].innerText,n[o].value=u[o].innerText,n[o].unit=i[o].innerText,n[o].time=t.getTime();lc.setItem("data",JSON.stringify(n))}else n[0].time=t.getTime(),lc.setItem("data",JSON.stringify(n));updateBadge()}function requestURL(e,t,a){var n=new XMLHttpRequest;n.responseType=a||"document",n.onreadystatechange=function(){4===n.readyState&&(200===n.status?t("document"===n.responseType?n.responseXML:n.responseText):t("offline"))},n.onerror=function(){},n.open("GET",e,!0),n.send()}function requestStatus(){requestURL(statusURL,updateStatus,"document"),timerID&&clearTimeout(timerID),timerID=setTimeout(requestStatus,lc.getItem("timerMs"))}function init(){$.extend(lc,defaultProps),$(window).on("storage",requestStatus),requestStatus()}var lc=localStorage,statusURL="http://www.bengo4.com",timerID,defaultProps={badgeType:"resPercent",timerMs:2e5,data:'[{"name":"lawyerNum","title":"登録弁護士数","value":"--","unit":"人"},{"name":"allAdvice","title":"相談件数（累計）","value":"--","unit":"件"},{"name":"d30Advice","title":"相談件数（月間）","value":"--","unit":"件"},{"name":"resPercent","title":"弁護士回答率","value":"--","unit":"%"},{"name":"reviewNum","title":"口コミ評価数","value":"--","unit":"件"}]'};$(function(e){init(e)});